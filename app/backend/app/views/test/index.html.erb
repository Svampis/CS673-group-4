<!DOCTYPE html>
<html>
<head>
  <title>Workfinder - API Testing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: #f5f5f5;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    header {
      background-color: #2c3e50;
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }
    
    header p {
      font-size: 1.1em;
      opacity: 0.9;
    }
    
    .back-link {
      display: inline-block;
      margin: 20px;
      color: #2c3e50;
      text-decoration: none;
      font-weight: 500;
    }
    
    .back-link:hover {
      text-decoration: underline;
    }
    
    .content {
      padding: 40px;
    }
    
    .section {
      margin-bottom: 40px;
    }
    
    .section h2 {
      color: #333;
      margin-bottom: 20px;
      font-size: 1.8em;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 10px;
    }
    
    .api-endpoint {
      background: #fafafa;
      border-left: 4px solid #2c3e50;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .api-endpoint h3 {
      color: #2c3e50;
      margin-bottom: 10px;
      font-size: 1.2em;
    }
    
    .method {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 4px;
      font-weight: bold;
      font-size: 0.85em;
      margin-right: 10px;
    }
    
    .method.get {
      background: #27ae60;
      color: white;
    }
    
    .method.post {
      background: #3498db;
      color: white;
    }
    
    .method.put {
      background: #f39c12;
      color: white;
    }
    
    .endpoint-url {
      font-family: 'Courier New', monospace;
      background: #e9ecef;
      padding: 8px 12px;
      border-radius: 4px;
      display: inline-block;
      margin: 10px 0;
      color: #333;
    }
    
    .test-section {
      background: #fafafa;
      padding: 20px;
      border-radius: 8px;
      margin-top: 30px;
    }
    
    .test-section h3 {
      margin-bottom: 15px;
      color: #333;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #555;
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1em;
      transition: border-color 0.3s;
      background: white;
    }
    
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #2c3e50;
    }
    
    button {
      background-color: #2c3e50;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 1em;
      cursor: pointer;
      transition: background-color 0.2s;
      font-weight: 600;
    }
    
    button:hover {
      background-color: #34495e;
    }
    
    .response {
      margin-top: 20px;
      padding: 15px;
      background: #e9ecef;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    
    .response.success {
      background: #d4edda;
      border-left: 4px solid #27ae60;
    }
    
    .response.error {
      background: #f8d7da;
      border-left: 4px solid #e74c3c;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .card {
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      transition: box-shadow 0.2s;
    }
    
    .card:hover {
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .card h4 {
      color: #2c3e50;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <a href="/" class="back-link">‚Üê Back to Home</a>
  
  <div class="container">
    <header>
      <h1>üîß Workfinder API Testing</h1>
      <p>Test and interact with the Workfinder API endpoints</p>
    </header>
    
    <div class="content">
      <div class="section">
        <h2>Available APIs</h2>
        
        <div class="api-endpoint">
          <h3>
            <span class="method get">GET</span>
            Search Tradesmen
          </h3>
          <div class="endpoint-url">/tradesmen?trade=plumber&location=ZIP</div>
          <p>Search for tradesmen by trade type and location</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method get">GET</span>
            Get Tradesman Schedule
          </h3>
          <div class="endpoint-url">/tradesman/:id/schedule</div>
          <p>Get available time slots for a specific tradesman</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method post">POST</span>
            Request Appointment
          </h3>
          <div class="endpoint-url">/appointments</div>
          <p>Create a new appointment request</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method put">PUT</span>
            Cancel Appointment
          </h3>
          <div class="endpoint-url">/appointments/:id/cancel</div>
          <p>Cancel an existing appointment</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method get">GET</span>
            Get Messages
          </h3>
          <div class="endpoint-url">/messages/:conversation_id</div>
          <p>Retrieve messages for a conversation</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method post">POST</span>
            Send Message
          </h3>
          <div class="endpoint-url">/messages</div>
          <p>Send a new message</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method post">POST</span>
            Leave Review
          </h3>
          <div class="endpoint-url">/reviews</div>
          <p>Submit a review for a tradesman</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method get">GET</span>
            Get Tradesman Reviews
          </h3>
          <div class="endpoint-url">/reviews/:tradesman_id</div>
          <p>Get all reviews for a specific tradesman</p>
        </div>
        
        <div class="api-endpoint">
          <h3>
            <span class="method post">POST</span>
            Create Tradesman Profile
          </h3>
          <div class="endpoint-url">/tradesman/profile</div>
          <p>Create or update a tradesman profile</p>
        </div>
      </div>
      
      <div class="test-section">
        <h3>üß™ API Testing</h3>
        <p style="margin-bottom: 20px; color: #666;">Test the APIs directly from this interface:</p>
        
        <div class="grid">
          <div class="card">
            <h4>Search Tradesmen</h4>
            <div class="form-group">
              <label>Trade:</label>
              <input type="text" id="search-trade" placeholder="e.g., plumber" value="plumber">
            </div>
            <div class="form-group">
              <label>Location:</label>
              <input type="text" id="search-location" placeholder="e.g., 12345">
            </div>
            <button onclick="searchTradesmen()">Search</button>
            <div id="search-response" class="response" style="display:none;"></div>
          </div>
          
          <div class="card">
            <h4>Get Schedule</h4>
            <div class="form-group">
              <label>Tradesman ID:</label>
              <input type="text" id="schedule-id" placeholder="Enter tradesman ID">
            </div>
            <button onclick="getSchedule()">Get Schedule</button>
            <div id="schedule-response" class="response" style="display:none;"></div>
          </div>
          
          <div class="card">
            <h4>Create Appointment</h4>
            <div class="form-group">
              <label>Homeowner ID:</label>
              <input type="text" id="appt-homeowner" placeholder="homeowner-uuid">
            </div>
            <div class="form-group">
              <label>Tradesman ID:</label>
              <input type="text" id="appt-tradesman" placeholder="tradesman-uuid">
            </div>
            <div class="form-group">
              <label>Start Time:</label>
              <input type="datetime-local" id="appt-start">
            </div>
            <div class="form-group">
              <label>End Time:</label>
              <input type="datetime-local" id="appt-end">
            </div>
            <div class="form-group">
              <label>Job Description:</label>
              <textarea id="appt-desc" placeholder="Describe the job"></textarea>
            </div>
            <button onclick="createAppointment()">Create Appointment</button>
            <div id="appt-response" class="response" style="display:none;"></div>
          </div>
          
          <div class="card">
            <h4>Send Message</h4>
            <div class="form-group">
              <label>Sender ID:</label>
              <input type="text" id="msg-sender" placeholder="sender-uuid">
            </div>
            <div class="form-group">
              <label>Receiver ID:</label>
              <input type="text" id="msg-receiver" placeholder="receiver-uuid">
            </div>
            <div class="form-group">
              <label>Message:</label>
              <textarea id="msg-content" placeholder="Your message"></textarea>
            </div>
            <button onclick="sendMessage()">Send Message</button>
            <div id="msg-response" class="response" style="display:none;"></div>
          </div>
          
          <div class="card">
            <h4>Leave Review</h4>
            <div class="form-group">
              <label>Homeowner ID:</label>
              <input type="text" id="review-homeowner" placeholder="homeowner-uuid">
            </div>
            <div class="form-group">
              <label>Tradesman ID:</label>
              <input type="text" id="review-tradesman" placeholder="tradesman-uuid">
            </div>
            <div class="form-group">
              <label>Rating (1-5):</label>
              <input type="number" id="review-rating" min="1" max="5" value="5">
            </div>
            <div class="form-group">
              <label>Comment:</label>
              <textarea id="review-comment" placeholder="Your review"></textarea>
            </div>
            <button onclick="leaveReview()">Submit Review</button>
            <div id="review-response" class="response" style="display:none;"></div>
          </div>
          
          <div class="card">
            <h4>Create Tradesman Profile</h4>
            <div class="form-group">
              <label>User ID:</label>
              <input type="text" id="profile-user-id" placeholder="user-uuid">
            </div>
            <div class="form-group">
              <label>Name:</label>
              <input type="text" id="profile-name" placeholder="John Doe">
            </div>
            <div class="form-group">
              <label>Email:</label>
              <input type="email" id="profile-email" placeholder="john@example.com">
            </div>
            <div class="form-group">
              <label>Trade:</label>
              <input type="text" id="profile-trade" placeholder="e.g., plumber">
            </div>
            <div class="form-group">
              <label>License Number:</label>
              <input type="text" id="profile-license" placeholder="ABC123">
            </div>
            <div class="form-group">
              <label>Business Name:</label>
              <input type="text" id="profile-business" placeholder="John's Plumbing">
            </div>
            <div class="form-group">
              <label>Experience (years):</label>
              <input type="number" id="profile-experience" min="0" value="5">
            </div>
            <div class="form-group">
              <label>Location:</label>
              <input type="text" id="profile-location" placeholder="ZIP code">
            </div>
            <button onclick="createProfile()">Create Profile</button>
            <div id="profile-response" class="response" style="display:none;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    const API_BASE = window.location.origin;
    
    function showResponse(elementId, data, isError = false) {
      const el = document.getElementById(elementId);
      el.style.display = 'block';
      el.className = 'response ' + (isError ? 'error' : 'success');
      el.textContent = JSON.stringify(data, null, 2);
    }
    
    async function searchTradesmen() {
      const trade = document.getElementById('search-trade').value;
      const location = document.getElementById('search-location').value;
      const params = new URLSearchParams();
      if (trade) params.append('trade', trade);
      if (location) params.append('location', location);
      
      try {
        const response = await fetch(`${API_BASE}/tradesmen?${params}`);
        const data = await response.json();
        showResponse('search-response', data, !response.ok);
      } catch (error) {
        showResponse('search-response', { error: error.message }, true);
      }
    }
    
    async function getSchedule() {
      const id = document.getElementById('schedule-id').value;
      if (!id) {
        showResponse('schedule-response', { error: 'Please enter a tradesman ID' }, true);
        return;
      }
      
      try {
        const response = await fetch(`${API_BASE}/tradesman/${id}/schedule`);
        const data = await response.json();
        showResponse('schedule-response', data, !response.ok);
      } catch (error) {
        showResponse('schedule-response', { error: error.message }, true);
      }
    }
    
    async function createAppointment() {
      const data = {
        homeowner_id: document.getElementById('appt-homeowner').value,
        tradesman_id: document.getElementById('appt-tradesman').value,
        scheduled_start: document.getElementById('appt-start').value,
        scheduled_end: document.getElementById('appt-end').value,
        job_description: document.getElementById('appt-desc').value
      };
      
      try {
        const response = await fetch(`${API_BASE}/appointments`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();
        showResponse('appt-response', result, !response.ok);
      } catch (error) {
        showResponse('appt-response', { error: error.message }, true);
      }
    }
    
    async function sendMessage() {
      const data = {
        sender_id: document.getElementById('msg-sender').value,
        receiver_id: document.getElementById('msg-receiver').value,
        content: document.getElementById('msg-content').value
      };
      
      try {
        const response = await fetch(`${API_BASE}/messages`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();
        showResponse('msg-response', result, !response.ok);
      } catch (error) {
        showResponse('msg-response', { error: error.message }, true);
      }
    }
    
    async function leaveReview() {
      const data = {
        homeowner_id: document.getElementById('review-homeowner').value,
        tradesman_id: document.getElementById('review-tradesman').value,
        rating: parseInt(document.getElementById('review-rating').value),
        comment: document.getElementById('review-comment').value
      };
      
      try {
        const response = await fetch(`${API_BASE}/reviews`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();
        showResponse('review-response', result, !response.ok);
      } catch (error) {
        showResponse('review-response', { error: error.message }, true);
      }
    }
    
    async function createProfile() {
      const data = {
        user_id: document.getElementById('profile-user-id').value,
        name: document.getElementById('profile-name').value,
        email: document.getElementById('profile-email').value,
        trade: document.getElementById('profile-trade').value,
        license_number: document.getElementById('profile-license').value,
        business_name: document.getElementById('profile-business').value,
        experience: parseInt(document.getElementById('profile-experience').value),
        location: document.getElementById('profile-location').value
      };
      
      try {
        const response = await fetch(`${API_BASE}/tradesman/profile`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await response.json();
        showResponse('profile-response', result, !response.ok);
      } catch (error) {
        showResponse('profile-response', { error: error.message }, true);
      }
    }
  </script>
</body>
</html>

